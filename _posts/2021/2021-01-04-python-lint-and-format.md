---
last_modified_at: 2021-03-08 23:03:15
title: "Python Lint And Format"
excerpt: "Some commands to lint and format Python files"
tags:
  - python
  - format
published: true
# header:
#   teaserlogo:
#   teaser: ''
#   image: ''
#   caption:
gallery:
  - image_path: ''
    url: ''
    title: ''
---

{% include toc title="Table of content" %}

## Lint

### pylint

As pylint has too many options, it recommends to use the pylint config file:

```bash
# file ~/.pylintrc, can be generated by pylint --generate-rcfile

[MESSAGES CONTROL]

# Enable the message, report, category or checker with the given id(s). You can
# either give multiple identifier separated by comma (,) or put this option
# multiple time.
#enable=

# Disable the message, report, category or checker with the given id(s). You
# can either give multiple identifier separated by comma (,) or put this option
# multiple time (only on the command line, not in the configuration file where
# it should appear only once).

# C116 for missing-function-docstring
disable=C0116
```

But we can also ignore some warnings directly in the pylint command:

```bash
pylint . -j 0 --disable=C0116
```

### flake8

```bash
# ignore W503 because of black format. BTW, flake8 also has W504 which is in contrary to W503.
flake8 . --exclude=venv --ignore=W503
flake8 [a_file_path]
```

### bandit

The bandit config file format is not well documented, I passed a lot of time to test the config.

```bash
$ cat .bandit
# https://github.com/PyCQA/bandit/issues/400
exclude_dirs:
  - "./venv/*"

# https://github.com/PyCQA/bandit/pull/633
assert_used:
  skips:
    - "*/*_test.py"
    - "*/test_*.py"
```

```bash
# without specifying -c ./bandit, it doesn't work
$ bandit . -r -c ./.bandit

```

### mypy

For projects having sqlalchemy, we often install the `sqlalchemy-stubs` plugin as sqlalchemy uses some dynamic classes.

And also [django-stubs](https://pypi.org/project/django-stubs/)

[mypy config file](https://mypy.readthedocs.io/en/stable/config_file.html):

```ini
[mypy]
ignore_missing_imports = True # We recommend using this approach only as a last resort: itâ€™s equivalent to adding a # type: ignore to all unresolved imports in your codebase.
plugins = sqlmypy # sqlalchemy-stubs
```

running mypy:

```bash
mypy .
mypy . --exclude [a regular expression that matches file path]
mypy . --exclude venv[//] # exclude venv folder under the root
```
## Format

### isort

```bash
isort . --profile=black --virtual-env=venv --recursive --check-only
isort . --profile=black --virtual-env=venv --recursive
isort [a_file_path]
```

Be very careful with isort, it's not uncompromising, especially for some codes that dynamically import some modules inside a function instead of from the beginning of a file. People use often this to avoid circular import problem. Always run the tests after the isort.
{: .notice--warning}

### black

```bash
black . --check
black .
black [a_file_path]
```

## VSCode

Just my 2 cents, try the [errorlens](https://marketplace.visualstudio.com/items?itemName=usernamehw.errorlens) extension in VSCode, it will lint all the warnings/errors on live when coding, it's really cool.

And don't forget to install the official [SonarLint](https://marketplace.visualstudio.com/items?itemName=SonarSource.sonarlint-vscode) extension, it will give you extra lint. It eats a lot of memory with its java processes nevertheless.
